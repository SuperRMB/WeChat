<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录</title>
    <link type="text/css" href="/static/css/login_page.css" rel="stylesheet">
</head>
<body>

<div class="bg">
    <div class="login_bg">

        <div class="title">密码登录</div>

        <div id = 'app' class="content">

            <form action="{% url 'login:login_page' %}" method="post">
                {% csrf_token %}
                <label>手机号：</label>
                <input type="text" placeholder="请输入手机号" name="mobile" maxlength="11" v-model="inputVal">
                <span id="mobile_tip">{{ mobile_error }}</span>
                <br>
                <label>密码：</label>
                <input type="password" placeholder="请输入密码" name="pwd">
                <span>{{ pwd_error }}</span>
                <br>
                <button type="submit">登录注册</button>
            </form>

        </div>


    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script type="text/javascript">

    var app = new Vue({
        el:'#app',
        data:{
            inputVal:''
        },
        watch:{
            inputVal:function (text) {
                if (text.length == 0){
                    document.getElementById('mobile_tip').innerText = ''
                } else if (text.charAt(0) != '1' || text.length < 11){
                    document.getElementById('mobile_tip').innerText = '手机号格式错误'
                }else if (text.length == 11 && text.charAt(0) == '1'){
                    document.getElementById('mobile_tip').innerText = ''
                    axios.get('{% url "login:mobile_legal" %}',{
                        params:{
                            mobile:text
                        }
                    }).then(function (response) {
                        var data = response.data
                        document.getElementById('mobile_tip').innerText = data.msg
                    });
                }
            }
        }
    })

</script>

</body>
</html>